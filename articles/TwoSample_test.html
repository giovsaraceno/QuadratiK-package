<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Non-parametric Two-sample test • QuadratiK</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Non-parametric Two-sample test">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">QuadratiK</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/generate_rpkb.html">Random sampling from the Poisson kernel-based density</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction to the QuadratiK Package</a></li>
    <li><a class="dropdown-item" href="../articles/kSample_test.html">k-sample test</a></li>
    <li><a class="dropdown-item" href="../articles/TwoSample_test.html">Non-parametric Two-sample test</a></li>
    <li><a class="dropdown-item" href="../articles/uniformity.html">Uniformity test on the Sphere</a></li>
    <li><a class="dropdown-item" href="../articles/wireless_clustering.html">Clustering algorithm on the Wireless data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/giovsaraceno/QuadratiK-package/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Non-parametric Two-sample test</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/giovsaraceno/QuadratiK-package/blob/master/vignettes/TwoSample_test.Rmd" class="external-link"><code>vignettes/TwoSample_test.Rmd</code></a></small>
      <div class="d-none name"><code>TwoSample_test.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="non-parametric-two-sample-test">Non-parametric two-sample test<a class="anchor" aria-label="anchor" href="#non-parametric-two-sample-test"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><msub><mi>n</mi><mn>1</mn></msub></msub><mo>∼</mo><mi>F</mi></mrow><annotation encoding="application/x-tex">x_1, x_2, \ldots, x_{n_1} \sim F</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>y</mi><msub><mi>n</mi><mn>2</mn></msub></msub><mo>∼</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">y_1, y_2, \ldots, y_{n_2} \sim G</annotation></semantics></math>
be random samples from the distributions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>,
respectively. We test the null hypothesis that the two samples are
generated from the same <em>unknown</em> distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>F</mi><mo accent="true">‾</mo></mover><annotation encoding="application/x-tex">\bar{F}</annotation></semantics></math>,
that is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>F</mi><mo>=</mo><mi>G</mi><mo>=</mo><mover><mi>F</mi><mo accent="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">
H_0: F = G = \bar{F}
</annotation></semantics></math></p>
<p>versus the alternative hypothesis that the two distributions are
different, that is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><mi>F</mi><mo>≠</mo><mi>G</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
H_1: F \not = G.
</annotation></semantics></math> We compute the kernel-based quadratic
distance (KBQD) tests</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">e</mi></mrow><mi>n</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mi>n</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mn>1</mn></msub></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>≠</mo><mi>i</mi></mrow><msub><mi>n</mi><mn>1</mn></msub></munderover><msub><mi>K</mi><mover><mi>F</mi><mo accent="true">‾</mo></mover></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐱</mi><mi>i</mi></msub><mo>,</mo><msub><mi>𝐱</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mrow><msub><mi>n</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mn>2</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mn>2</mn></msub></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>≠</mo><mi>i</mi></mrow><msub><mi>n</mi><mn>2</mn></msub></munderover><msub><mi>K</mi><mover><mi>F</mi><mo accent="true">‾</mo></mover></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐲</mi><mi>i</mi></msub><mo>,</mo><msub><mi>𝐲</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
    \mathrm{trace}_n =  \frac{1}{n_1(n_1-1)}\sum_{i=1}^{n_1} \sum_{j \not=i}^{n_1} K_{\bar{F}}(\mathbf{x}_i,\mathbf{x}_j) + \frac{1}{n_2(n_2-1)}\sum_{i=1}^{n_2} \sum_{j \not=i}^{n_2} K_{\bar{F}}(\mathbf{y}_i,\mathbf{y}_j),
</annotation></semantics></math> and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>n</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mi>n</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mn>1</mn></msub></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>≠</mo><mi>i</mi></mrow><msub><mi>n</mi><mn>2</mn></msub></munderover><msub><mi>K</mi><mover><mi>F</mi><mo accent="true">‾</mo></mover></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐱</mi><mi>i</mi></msub><mo>,</mo><msub><mi>𝐱</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mfrac><mn>2</mn><mrow><msub><mi>n</mi><mn>1</mn></msub><msub><mi>n</mi><mn>2</mn></msub></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mn>1</mn></msub></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mn>2</mn></msub></munderover><msub><mi>K</mi><mover><mi>F</mi><mo accent="true">‾</mo></mover></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐱</mi><mi>i</mi></msub><mo>,</mo><msub><mi>𝐲</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mrow><msub><mi>n</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mn>2</mn></msub><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mn>2</mn></msub></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>≠</mo><mi>i</mi></mrow><msub><mi>n</mi><mn>2</mn></msub></munderover><msub><mi>K</mi><mover><mi>F</mi><mo accent="true">‾</mo></mover></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐲</mi><mi>i</mi></msub><mo>,</mo><msub><mi>𝐲</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
    D_{n} =  \frac{1}{n_1(n_1-1)}\sum_{i=1}^{n_1} \sum_{j \not=i}^{n_2} K_{\bar{F}}(\mathbf{x}_i,\mathbf{x}_j) - \frac{2}{n_1 n_2}\sum_{i=1}^{n_1} \sum_{j =1}^{n_2} K_{\bar{F}}(\mathbf{x}_i,\mathbf{y}_j) 
     + \frac{1}{n_2(n_2-1)}\sum_{i=1}^{n_2} \sum_{j \not=i}^{n_2} K_{\bar{F}}(\mathbf{y}_i,\mathbf{y}_j).  \nonumber
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mover><mi>F</mi><mo accent="true">‾</mo></mover></msub><annotation encoding="application/x-tex">K_{\bar{F}}</annotation></semantics></math>
denotes the Normal kernel
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
defined as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐬</mi><mo>,</mo><mi>𝐭</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>π</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mi>d</mi><mi>/</mi><mn>2</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>det</mo><msub><mi>𝚺</mi><mi>h</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow></msup><mo>exp</mo><mrow><mo stretchy="true" form="prefix">{</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐬</mi><mo>−</mo><mi>𝐭</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>⊤</mi></msup><msubsup><mi>𝚺</mi><mi>h</mi><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐬</mi><mo>−</mo><mi>𝐭</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
K(\mathbf{s}, \mathbf{t}) = (2 \pi)^{-d/2} 
\left(\det{\mathbf{\Sigma}_h}\right)^{-\frac{1}{2}}  
\exp\left\{-\frac{1}{2}(\mathbf{s} - \mathbf{t})^\top 
\mathbf{\Sigma}_h^{-1}(\mathbf{s} - \mathbf{t})\right\},
</annotation></semantics></math></p>
<p>for every
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐬</mi><mo>,</mo><mi>𝐭</mi><mo>∈</mo><msup><mi>ℝ</mi><mi>d</mi></msup><mo>×</mo><msup><mi>ℝ</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{s}, \mathbf{t} \in \mathbb{R}^d \times
\mathbb{R}^d</annotation></semantics></math>, with covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝚺</mi><mi>h</mi></msub><mo>=</mo><msup><mi>h</mi><mn>2</mn></msup><mi>I</mi></mrow><annotation encoding="application/x-tex">\mathbf{\Sigma}_h = h^2 I</annotation></semantics></math>
and tuning parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>,
centered with respect to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>F</mi><mo accent="true">‾</mo></mover><mo>=</mo><mfrac><mrow><msub><mi>n</mi><mn>1</mn></msub><mi>F</mi><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub><mi>G</mi></mrow><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\bar{F} = \frac{n_1F + n_2G}{n_1 + n_2}</annotation></semantics></math>.
For more information about the centering of the kernel, see the
documentation of the <code><a href="../reference/kb.test.html">kb.test()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">kb.test</span><span class="op">)</span> </span></code></pre></div>
<p>The KBQD tests exhibit high power against asymmetric alternatives
that are close to the null hypothesis and with small sample size. We
consider an example of this scenario. We generate the samples
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">x = (x_1, \ldots,x_n)</annotation></semantics></math>
from a standard normal distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>d</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>I</mi><mi>d</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N_d(0,I_d)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>y</mi><mi>n</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y = (y_1, \ldots,y_n)</annotation></semantics></math>
from a skew-normal distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><msub><mi>N</mi><mi>d</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>I</mi><mi>d</mi></msub><mo>,</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">SN_d(0,I_d, \lambda)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">d=4</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">n=100</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.5</mn><mo>,</mo><mi>…</mi><mo>,</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda= (0.5,\ldots,0.5)</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://azzalini.stat.unipd.it/SN/" class="external-link">sn</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=QuadratiK" class="external-link">QuadratiK</a></span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">skewness_y</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2468</span><span class="op">)</span></span>
<span><span class="va">x_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">d</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sn/man/dmsn.html" class="external-link">rmsn</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>, xi<span class="op">=</span><span class="fl">0</span>, Omega <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">skewness_y</span>,<span class="va">d</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The two-sample test can be performed by providing the two samples to
be compared as <code>x</code> and <code>y</code> to the
<code><a href="../reference/kb.test.html">kb.test()</a></code> function. If a value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
is not provided, the function automatically performs the function
<code>select_h</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2468</span><span class="op">)</span></span>
<span><span class="va">two_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kb.test.html">kb.test</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x_2</span>, y<span class="op">=</span><span class="va">y_2</span><span class="op">)</span></span>
<span><span class="va">two_test</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Kernel-based quadratic distance two-sample test </span></span>
<span><span class="co">## U-statistic   Dn          Trace </span></span>
<span><span class="co">## ------------------------------------------------</span></span>
<span><span class="co">## Test Statistic:   1.679763    2.312427 </span></span>
<span><span class="co">## Critical Value:   1.087455    1.497868 </span></span>
<span><span class="co">## H0 is rejected:   TRUE        TRUE </span></span>
<span><span class="co">## CV method:  subsampling </span></span>
<span><span class="co">## Selected tuning parameter h:  1.6</span></span></code></pre>
<p>We can display the chosen <em>optimal</em> value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
together with the power plot obtained versus the considered
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>,
for the alternatives
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
in the <code><a href="../reference/select_h.html">select_h()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">two_test</span><span class="op">@</span><span class="va">h</span><span class="op">$</span><span class="va">h_sel</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.6</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">two_test</span><span class="op">@</span><span class="va">h</span><span class="op">$</span><span class="va">power.plot</span></span></code></pre></div>
<p><img src="TwoSample_test_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<p>For more details visit the help documentation of the
<code><a href="../reference/select_h.html">select_h()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/help.html" class="external-link">help</a></span><span class="op">(</span><span class="va">select_h</span><span class="op">)</span> </span></code></pre></div>
<p>For the two-sample case, the <code>summary</code> function provides
the results from the test and a list tables of the standard descriptive
statistics for each variable, computed per group and overall.
Additionally, it generates the qq-plots comparing the quantiles of the
two groups for each variable.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">two_test</span><span class="op">)</span></span></code></pre></div>
<p><img src="TwoSample_test_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Kernel-based quadratic distance two-sample test </span></span>
<span><span class="co">##   Statistic    Value Critical_Value Reject_H0</span></span>
<span><span class="co">## 1        Dn 1.679763       1.087455      TRUE</span></span>
<span><span class="co">## 2     Trace 2.312427       1.497868      TRUE</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_two</span><span class="op">$</span><span class="va">summary_tables</span></span></code></pre></div>
<pre><code><span><span class="co">## [[1]]</span></span>
<span><span class="co">##             Group 1    Group 2    Overall</span></span>
<span><span class="co">## mean   -0.005393522  0.3197861  0.1571963</span></span>
<span><span class="co">## sd      1.039119207  0.9094193  0.9875137</span></span>
<span><span class="co">## median -0.019317321  0.4448058  0.1601955</span></span>
<span><span class="co">## IQR     1.562613453  1.3612937  1.4292426</span></span>
<span><span class="co">## min    -2.675477796 -1.4256211 -2.6754778</span></span>
<span><span class="co">## max     2.151784802  2.9375947  2.9375947</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##            Group 1    Group 2     Overall</span></span>
<span><span class="co">## mean   -0.10005083  0.1936138  0.04678149</span></span>
<span><span class="co">## sd      1.10476260  1.0556439  1.08777010</span></span>
<span><span class="co">## median -0.07955849  0.2235325  0.10130247</span></span>
<span><span class="co">## IQR     1.48816630  1.4716179  1.41498342</span></span>
<span><span class="co">## min    -3.22222061 -2.4336333 -3.22222061</span></span>
<span><span class="co">## max     2.50192633  2.6879362  2.68793623</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">##             Group 1    Group 2     Overall</span></span>
<span><span class="co">## mean   -0.006524772  0.1701261  0.08180065</span></span>
<span><span class="co">## sd      0.958942739  0.9524916  0.95742170</span></span>
<span><span class="co">## median -0.039301279  0.1887394  0.11877637</span></span>
<span><span class="co">## IQR     1.329868172  1.4657107  1.40312077</span></span>
<span><span class="co">## min    -2.860006689 -2.1762183 -2.86000669</span></span>
<span><span class="co">## max     1.923763114  2.4237195  2.42371949</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[4]]</span></span>
<span><span class="co">##            Group 1    Group 2     Overall</span></span>
<span><span class="co">## mean   -0.06757686  0.2236458  0.07803449</span></span>
<span><span class="co">## sd      0.98684958  0.9862135  0.99481815</span></span>
<span><span class="co">## median -0.03258747  0.1097711  0.05517931</span></span>
<span><span class="co">## IQR     1.30933016  1.4088334  1.39890664</span></span>
<span><span class="co">## min    -2.29625537 -2.1827156 -2.29625537</span></span>
<span><span class="co">## max     2.40795077  2.9929942  2.99299420</span></span></code></pre>
<div class="section level4">
<h4 id="select-h">Select h<a class="anchor" aria-label="anchor" href="#select-h"></a>
</h4>
<p>The search for the <em>optimal</em> value of the tuning parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
can be performed independently from the test computation using the
<code>select_h</code> function. It requires the two samples, provided as
<code>x</code> and <code>y</code>, and the considered family of
alternatives.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2468</span><span class="op">)</span></span>
<span><span class="va">two_test_h</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_h.html">select_h</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x_2</span>, y<span class="op">=</span><span class="va">y_2</span>, alternative <span class="op">=</span> <span class="st">"skewness"</span><span class="op">)</span></span></code></pre></div>
<p>The code is not evaluated since we would obtain the same results.</p>
</div>
<div class="section level4">
<h4 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h4>
<p>Notice that the test statistics for two-sample testing coincide with
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-sample
test statistics when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">k=2</annotation></semantics></math>.
Hence, alternatively the two sample tests can be performed providing the
two samples together as <code>x</code> and indicating the membership to
the groups with the argument <code>y</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_pool</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x_2</span>,<span class="va">y_2</span><span class="op">)</span></span>
<span><span class="va">y_memb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,each<span class="op">=</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="va">two_test</span><span class="op">@</span><span class="va">h</span><span class="op">$</span><span class="va">h_sel</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2468</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/kb.test.html">kb.test</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x_pool</span>, y<span class="op">=</span><span class="va">y_memb</span>, h<span class="op">=</span><span class="va">h</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Kernel-based quadratic distance k-sample test </span></span>
<span><span class="co">## U-statistic   Dn          Trace </span></span>
<span><span class="co">## ------------------------------------------------</span></span>
<span><span class="co">## Test Statistic:   1.679763    2.312427 </span></span>
<span><span class="co">## Critical Value:   1.087455    1.497868 </span></span>
<span><span class="co">## H0 is rejected:   TRUE        TRUE </span></span>
<span><span class="co">## CV method:  subsampling </span></span>
<span><span class="co">## Selected tuning parameter h:  1.6</span></span></code></pre>
<p>See the <em>k-sample test</em> vignette for more details.</p>
<p>In the <code><a href="../reference/kb.test.html">kb.test()</a></code> function, the critical value can be
computed with the subsampling, bootstrap or permutation algorithm. The
default method is set to subsampling since it needs less computational
time. For details on the sampling algorithm see the documentation of the
<code><a href="../reference/kb.test.html">kb.test()</a></code> function.</p>
<p>For more details on the level and power performance of the considered
two-sample tests, see the extensive simulation study reported in the
following reference.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Markatou Marianthi &amp; Saraceno Giovanni (2024). “A Unified
Framework for Multivariate Two- and k-Sample Kernel-based Quadratic
Distance Goodness-of-Fit Tests.”<br><a href="https://doi.org/10.48550/arXiv.2407.16374" class="external-link">https://doi.org/10.48550/arXiv.2407.16374</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giovanni Saraceno, Marianthi Markatou, Raktim Mukhopadhyay, Mojgan Golzy.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
